<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Contact | Attral Store</title>
  <meta name="description" content="Contact Attral Store for support or inquiries." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css" />
  
  <!-- Google Analytics 4 -->
  <script src="js/analytics.js"></script>
  
  <style>
    /* Center the hero content */
    .contact-hero .hero-content {
      display: flex;
      justify-content: center;
      align-items: center;
      text-align: center;
    }
    
    .contact-hero .hero-text {
      text-align: center;
    }
    
    .contact-hero h1 {
      text-align: center;
      margin: 0 auto;
    }
    
    .contact-hero .hero-subtitle {
      text-align: center;
      margin: 0 auto;
    }
    
    /* Loading animation for submit button */
    .btn:disabled {
      opacity: 0.7;
      cursor: not-allowed;
    }
    
    .loading-icon {
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    /* Authentication UI Styles */
    .auth-check-section {
      text-align: center;
      padding: 40px 20px;
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      border-radius: 12px;
      border: 1px solid #e2e8f0;
      margin-bottom: 20px;
    }
    
    .auth-message .auth-icon {
      width: 60px;
      height: 60px;
      margin: 0 auto 20px;
      color: #ff6b35;
      background: rgba(255, 107, 53, 0.1);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .auth-message .auth-icon svg {
      width: 30px;
      height: 30px;
    }
    
    .auth-message h3 {
      color: #1e293b;
      margin-bottom: 10px;
      font-size: 1.5rem;
      font-weight: 600;
    }
    
    .auth-message p {
      color: #64748b;
      margin-bottom: 30px;
      line-height: 1.6;
      max-width: 400px;
      margin-left: auto;
      margin-right: auto;
    }
    
    .auth-actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      flex-wrap: wrap;
    }
    
    .btn-secondary {
      background: transparent;
      color: #ff6b35;
      border: 2px solid #ff6b35;
    }
    
    .btn-secondary:hover {
      background: #ff6b35;
      color: white;
    }
    
    /* User Info Display */
    .user-info-display {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 12px;
      margin-bottom: 20px;
      color: white;
    }
    
    .user-avatar {
      width: 50px;
      height: 50px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }
    
    .user-avatar svg {
      width: 24px;
      height: 24px;
    }
    
    .user-details {
      flex: 1;
    }
    
    .user-name {
      font-weight: 600;
      font-size: 1.1rem;
      margin-bottom: 4px;
    }
    
    .user-email {
      font-size: 0.9rem;
      opacity: 0.9;
    }
    
    .sign-out-btn {
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      flex-shrink: 0;
    }
    
    .sign-out-btn:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: translateY(-2px);
    }
    
    .sign-out-btn svg {
      width: 20px;
      height: 20px;
    }
    
    /* Readonly input styling */
    .form-input[readonly] {
      background: #f8fafc;
      color: #64748b;
      cursor: default;
    }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="logo" href="index.html"><img src="logo.png" alt="ATTRAL" style="height:40px; width:auto;" /></a>
      <button class="hamburger-menu" aria-label="Toggle menu" id="hamburger-menu-btn">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <nav class="nav">
        <a href="index.html">Home</a>
        <a href="shop.html">Shop</a>
        <a href="account.html">My Account</a>
        <a href="affiliates.html">Affiliate Central</a>
        <a href="contact.html" class="active">Contact Us</a>
        <div class="dropdown">
          <a href="#" class="dropdown-toggle">More ‚ñæ</a>
          <div class="dropdown-menu">
            <a href="about.html">About Us</a>
            <a href="blog.html">Blog</a>
            <a href="privacy.html">Privacy</a>
            <a href="terms.html">Terms</a>
          </div>
        </div>
        <a href="cart.html" class="cart-link">Cart <span id="cart-count" class="badge">0</span></a>
      </nav>
    </div>
  </header>

  <!-- Mobile Navigation Overlay -->
  <div class="mobile-nav-overlay" id="mobile-nav-overlay"></div>

  <!-- Mobile Navigation Menu -->
  <div class="mobile-nav-menu" id="mobile-nav-menu">
    <div class="mobile-nav-menu-header">
      <button class="mobile-nav-close" aria-label="Close menu" id="mobile-nav-close">√ó</button>
    </div>
    <div class="mobile-nav-menu-content">
      <nav class="nav">
        <a href="index.html">Home</a>
        <a href="shop.html">Shop</a>
        <a href="account.html">My Account</a>
        <a href="affiliates.html">Affiliate Central</a>
        <a href="contact.html" class="active">Contact Us</a>
        <a href="about.html">About Us</a>
        <a href="blog.html">Blog</a>
        <a href="privacy.html">Privacy</a>
        <a href="terms.html">Terms</a>
        <a href="cart.html" class="cart-link">Cart <span id="mobile-cart-count" class="badge">0</span></a>
      </nav>
    </div>
  </div>

  <main class="container">
    <!-- Hero Section -->
    <section class="contact-hero">
      <div class="hero-content">
        <div class="hero-text">
          <h1>Get in Touch üìû</h1>
          <p class="hero-subtitle">We'd love to hear from you! Send us a message and we'll respond as soon as possible.</p>
        </div>
      </div>
    </section>

    <!-- Contact Content -->
    <section class="contact-content">
      <div class="contact-grid">
        <!-- Contact Form -->
        <div class="contact-form-section">
          <div class="form-card">
            <h2>Send us a Message</h2>
            <!-- Authentication Check -->
            <div id="authCheck" class="auth-check-section" style="display: none;">
              <div class="auth-message">
                <div class="auth-icon">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"/>
                  </svg>
                </div>
                <h3>Sign In Required</h3>
                <p>Please sign in to your account to send us a message. This helps us provide better support and track your inquiries.</p>
                <div class="auth-actions">
                  <a href="account.html" class="btn btn-primary">Sign In</a>
                  <a href="account.html" class="btn btn-secondary">Create Account</a>
                </div>
              </div>
            </div>

            <form class="contact-form" id="contactForm">
              <!-- User Info Display (for authenticated users) -->
              <div class="user-info-display" id="userInfoDisplay" style="display: none;">
                <div class="user-avatar">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                  </svg>
                </div>
                <div class="user-details">
                  <div class="user-name" id="userName">Loading...</div>
                  <div class="user-email" id="userEmail">Loading...</div>
                </div>
                <button type="button" class="sign-out-btn" id="signOutBtn" title="Sign Out">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"/>
                  </svg>
                </button>
              </div>
              
              <div class="form-group">
                <div class="input-wrapper">
                  <input class="form-input" type="text" name="name" placeholder="Your Name" required />
                  <div class="input-icon">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                      <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                    </svg>
                  </div>
                </div>
              </div>
              
              <div class="form-group">
                <div class="input-wrapper">
                  <input class="form-input" type="email" name="email" placeholder="Your Email" required />
                  <div class="input-icon">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                      <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                    </svg>
                  </div>
                </div>
              </div>
              
              <div class="form-group">
                <div class="input-wrapper">
                  <textarea class="form-input" name="message" rows="5" placeholder="Your Message" required></textarea>
                  <div class="input-icon textarea-icon">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                      <path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"/>
                    </svg>
                  </div>
                </div>
              </div>
              
              <button class="btn btn-primary btn-large" type="submit" id="submitBtn">
                <span id="submitText">Send Message</span>
                <svg class="btn-icon" viewBox="0 0 24 24" fill="currentColor" id="submitIcon">
                  <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                </svg>
                <svg class="btn-icon loading-icon" viewBox="0 0 24 24" fill="currentColor" style="display: none;">
                  <path d="M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z"/>
                </svg>
              </button>
            </form>
          </div>
        </div>

        <!-- Contact Info -->
        <div class="contact-info-section">
          <div class="info-card">
            <h2>Contact Information</h2>
            <p>Reach out to us through any of these channels:</p>
            
            <div class="contact-methods">
              <div class="contact-method">
                <div class="method-icon">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/>
                  </svg>
                </div>
                <div class="method-content">
                  <h3>Phone</h3>
                  <p>+91 8903479870</p>
                  <span>Mon-Fri 9AM-6PM IST</span>
                </div>
              </div>

              <div class="contact-method">
                <div class="method-icon">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                  </svg>
                </div>
                <div class="method-content">
                  <h3>Email</h3>
                  <p>info@attral.in</p>
                  <span>We'll respond within 24 hours</span>
                </div>
              </div>

              <div class="contact-method">
                <div class="method-icon">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                  </svg>
                </div>
                <div class="method-content">
                  <h3>Address</h3>
                  <p>Phase 2 Sathuvachari<br>Vellore - 632009<br>Tamil Nadu, India</p>
                </div>
              </div>

              <div class="contact-method">
                <div class="method-icon">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                  </svg>
                </div>
                <div class="method-content">
                  <h3>Support</h3>
                  <p>24/7 Customer Support</p>
                  <span>Technical assistance available</span>
                </div>
              </div>
            </div>

            <!-- Social Links -->
            <div class="social-section">
              <h3>Follow Us</h3>
              <div class="social-links">
                <a href="https://www.facebook.com/people/Attral-consumer-electronics/61576279500514/" target="_blank" rel="noopener" title="Follow us on Facebook">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                  </svg>
                </a>
                <a href="https://instagram.com/attral_electronics" target="_blank" rel="noopener" title="Follow us on Instagram">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                  </svg>
                </a>
               </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container footer-inner">
      <div class="footer-content">
        <div class="footer-section">
          <h4>About ATTRAL</h4>
          <p>Smart Power. Smarter Living. We provide next-gen consumer electronics to power your lifestyle with cutting-edge GaN technology.</p>
          <div class="social-links">
            <a href="https://www.facebook.com/people/Attral-consumer-electronics/61576279500514/" target="_blank" rel="noopener" title="Follow us on Facebook">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
              </svg>
            </a>
            <a href="https://instagram.com/attral_electronics" target="_blank" rel="noopener" title="Follow us on Instagram">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
              </svg>
            </a>
          </div>
        </div>
        <div class="footer-section">
          <h4>Quick Links</h4>
          <p><a href="index.html">Home</a></p>
          <p><a href="shop.html">Shop</a></p>
          <p><a href="about.html">About Us</a></p>
          <p><a href="contact.html">Contact</a></p>
        </div>
        <div class="footer-section">
          <h4>Support</h4>
          <p><a href="account.html">My Account</a></p>
          <p><a href="cart.html">Shopping Cart</a></p>
          <p><a href="affiliates.html">Affiliate Program</a></p>
          <p><a href="blog.html">Blog</a></p>
        </div>
        <div class="footer-section">
          <h4>Contact Info</h4>
          <p>üìß info@attral.in</p>
          <p>üì± +91 8903479870</p>
          <p>üìç Phase 2 Sathuvachari<br>Vellore - 632009<br>Tamil Nadu, India</p>
        </div>
      </div>
      <div class="footer-bottom">
        <p>¬© <span id="year"></span> ATTRAL. All rights reserved.</p>
        <nav>
          <a href="privacy.html">Privacy Policy</a>
          <a href="terms.html">Terms of Service</a>
          <a href="sitemap.xml">Sitemap</a>
        </nav>
      </div>
    </div>
  </footer>

  <script src="js/config.js"></script>
  <script src="js/app.js"></script>
  <script src="js/firebase.js"></script>
  <script src="js/dropdown.js"></script>
  <script>
    document.getElementById('year').textContent = new Date().getFullYear();
    window.Attral.initHeaderCartCount();
    
    // Authentication and Contact Form Management
    class ContactFormManager {
      constructor() {
        this.authCheck = document.getElementById('authCheck');
        this.contactForm = document.getElementById('contactForm');
        this.userInfoDisplay = document.getElementById('userInfoDisplay');
        this.userName = document.getElementById('userName');
        this.userEmail = document.getElementById('userEmail');
        this.signOutBtn = document.getElementById('signOutBtn');
        this.nameInput = document.querySelector('input[name="name"]');
        this.emailInput = document.querySelector('input[name="email"]');
        this.messageInput = document.querySelector('textarea[name="message"]');
        
        this.init();
      }
      
      init() {
        // Wait for AuthManager to be ready
        if (window.AuthManager) {
          this.setupAuthListener();
        } else {
          // Wait for AuthManager to load, but show form as fallback
          setTimeout(() => {
            if (window.AuthManager) {
              this.setupAuthListener();
            } else {
              // Fallback: show form without authentication
              this.showFallbackForm();
            }
          }, 100);
        }
        
        // Setup sign out button
        if (this.signOutBtn) {
          this.signOutBtn.addEventListener('click', () => this.signOut());
        }
        
        // Setup form submission
        if (this.contactForm) {
          this.contactForm.addEventListener('submit', (e) => this.handleSubmit(e));
        }
      }
      
      setupAuthListener() {
        window.AuthManager.addAuthStateListener((user) => {
          this.handleAuthStateChange(user);
        });
      }
      
      handleAuthStateChange(user) {
        if (user && !user.isAnonymous) {
          // User is signed in
          this.showContactForm(user);
        } else {
          // User is not signed in
          this.showSignInPrompt();
        }
      }
      
      showSignInPrompt() {
        this.authCheck.style.display = 'block';
        this.contactForm.style.display = 'none';
      }
      
      showFallbackForm() {
        // Show form without authentication for fallback
        this.authCheck.style.display = 'none';
        this.contactForm.style.display = 'block';
        this.userInfoDisplay.style.display = 'none';
        
        // Make inputs editable
        this.nameInput.removeAttribute('readonly');
        this.emailInput.removeAttribute('readonly');
        
        // Update placeholders
        this.nameInput.placeholder = 'Your Name';
        this.emailInput.placeholder = 'Your Email';
        
        console.log('Contact form running in fallback mode (no authentication)');
      }
      
      showContactForm(user) {
        this.authCheck.style.display = 'none';
        this.contactForm.style.display = 'block';
        
        // Populate user info
        const displayName = user.displayName || user.email?.split('@')[0] || 'User';
        const email = user.email || '';
        
        this.userName.textContent = displayName;
        this.userEmail.textContent = email;
        this.nameInput.value = displayName;
        this.emailInput.value = email;
      }
      
      async signOut() {
        try {
          await window.AuthManager.signOut();
          window.Attral.notify('Signed out successfully');
        } catch (error) {
          console.error('Sign out error:', error);
          window.Attral.notify('Error signing out');
        }
      }
      
      showEnhancedSuccessMessage() {
        // Create a beautiful success notification
        const successNotification = document.createElement('div');
        successNotification.style.cssText = `
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          background: linear-gradient(135deg, #10b981, #34d399);
          color: white;
          padding: 30px 40px;
          border-radius: 20px;
          box-shadow: 0 20px 60px rgba(16, 185, 129, 0.4),
                      0 0 0 10px rgba(16, 185, 129, 0.1);
          z-index: 10000;
          font-weight: 700;
          font-size: 18px;
          text-align: center;
          max-width: 500px;
          animation: successBounce 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
          backdrop-filter: blur(10px);
          border: 2px solid rgba(255, 255, 255, 0.2);
        `;
        
        successNotification.innerHTML = `
          <div style="font-size: 48px; margin-bottom: 15px;">üéâ</div>
          <div style="margin-bottom: 15px; font-size: 20px;">Message Sent Successfully!</div>
          <div style="font-size: 16px; margin-bottom: 20px; opacity: 0.9; line-height: 1.4;">
            Thank you for contacting us! We'll get back to you within 24 hours.
          </div>
          <div style="font-size: 14px; opacity: 0.8; background: rgba(255, 255, 255, 0.1); padding: 10px; border-radius: 8px; margin-top: 15px;">
            <strong>Need immediate assistance?</strong><br>
            üìß Email: info@attral.in<br>
            üì± Phone: +91 8903479870
          </div>
        `;
        
        document.body.appendChild(successNotification);
        
        // Add CSS animation
        const style = document.createElement('style');
        style.textContent = `
          @keyframes successBounce {
            0% {
              opacity: 0;
              transform: translate(-50%, -50%) scale(0.3);
            }
            50% {
              opacity: 1;
              transform: translate(-50%, -50%) scale(1.05);
            }
            100% {
              opacity: 1;
              transform: translate(-50%, -50%) scale(1);
            }
          }
          
          @keyframes successFadeOut {
            0% {
              opacity: 1;
              transform: translate(-50%, -50%) scale(1);
            }
            100% {
              opacity: 0;
              transform: translate(-50%, -50%) scale(0.8);
            }
          }
        `;
        document.head.appendChild(style);
        
        // Auto-hide after 5 seconds
        setTimeout(() => {
          successNotification.style.animation = 'successFadeOut 0.4s ease-in forwards';
          setTimeout(() => {
            successNotification.remove();
            style.remove();
          }, 400);
        }, 5000);
        
        // Also show a regular notification as backup
        window.Attral.notify('Thank you! We\'ll get back to you soon.', 'success');
      }
      
      async saveMessageToFirestore(data) {
        try {
          // Wait for Firebase to be ready
          const maxWait = 5000; // 5 seconds
          const startTime = Date.now();
          
          while (!window.AttralFirebase || !window.AttralFirebase.db) {
            if (Date.now() - startTime > maxWait) {
              console.warn('Firebase not ready after 5s, skipping Firestore save');
              return;
            }
            await new Promise(resolve => setTimeout(resolve, 100));
          }
          
          // Prepare message data for Firestore
          const messageData = {
            name: data.name,
            email: data.email.toLowerCase(),
            message: data.message,
            isAuthenticated: data.isAuthenticated,
            userToken: data.userToken ? 'provided' : null, // Don't store actual token
            timestamp: new Date(),
            status: 'new',
            source: 'contact_form',
            ipAddress: null, // Could be added if needed
            userAgent: navigator.userAgent,
            read: false,
            replied: false
          };
          
          // Save to Firestore
          const docRef = await window.AttralFirebase.db.collection('contact_messages').add(messageData);
          console.log('‚úÖ Contact message saved to Firestore with ID:', docRef.id);
          
          return docRef.id;
          
        } catch (error) {
          console.error('‚ùå Failed to save contact message to Firestore:', error);
          // Don't throw error - let the form still work even if Firestore fails
          throw error;
        }
      }
      
      async handleSubmit(e) {
        e.preventDefault();
        
        const submitBtn = document.getElementById('submitBtn');
        const submitText = document.getElementById('submitText');
        const submitIcon = document.getElementById('submitIcon');
        const loadingIcon = submitBtn.querySelector('.loading-icon');
        
        // Get form data
        const formData = new FormData(this.contactForm);
        const user = window.AuthManager ? window.AuthManager.getCurrentUser() : null;
        const data = {
          name: formData.get('name').trim(),
          email: formData.get('email').trim(),
          message: formData.get('message').trim(),
          userToken: user ? await user.getIdToken() : null,
          isAuthenticated: !!user
        };
        
        // Validate form data
        if (!data.name || !data.email || !data.message) {
          window.Attral.notify('Please fill in all fields.', 'error');
          return;
        }
        
        // Email validation
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(data.email)) {
          window.Attral.notify('Please enter a valid email address.', 'error');
          return;
        }
        
        // Show loading state
        submitBtn.disabled = true;
        submitText.textContent = 'Sending...';
        submitIcon.style.display = 'none';
        loadingIcon.style.display = 'block';
        
        try {
          // Save to Firestore first (always works if Firebase is available)
          await this.saveMessageToFirestore(data);
          
          // Use new contact handler that sends automated emails
          const apiBaseUrl = window.ATTRAL_PUBLIC?.API_BASE_URL || '';
          const apiUrl = `${apiBaseUrl}/api/contact_handler.php`;
          
          const response = await fetch(apiUrl, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              name: data.name,
              email: data.email,
              message: data.message,
              phone: formData.get('phone') || ''
            })
          });
          
          if (response.ok) {
            const result = await response.json();
            
            if (result.success) {
              // Show enhanced success message
              this.showEnhancedSuccessMessage();
              this.messageInput.value = ''; // Clear only the message field
            } else {
              window.Attral.notify(result.message || 'Failed to send message. Please try again.', 'error');
            }
          } else {
            // API not available (production domain), but Firestore save succeeded
            this.showEnhancedSuccessMessage();
            this.messageInput.value = ''; // Clear only the message field
            console.log('API endpoint not available, but message saved to Firestore');
          }
          
        } catch (error) {
          console.error('Contact form error:', error);
          // Show success message even if API fails (Firestore save should have worked)
          this.showEnhancedSuccessMessage();
          this.messageInput.value = ''; // Clear only the message field
          console.log('API call failed, but message should be saved to Firestore');
        } finally {
          // Reset button state
          submitBtn.disabled = false;
          submitText.textContent = 'Send Message';
          submitIcon.style.display = 'block';
          loadingIcon.style.display = 'none';
        }
      }
    }
    
    // Initialize the contact form manager
    new ContactFormManager();
  </script>
</body>
</html>


