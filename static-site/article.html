<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title id="article-title">ATTRAL Blog Article</title>
  <meta name="description" id="article-description" content="Read the latest insights from ATTRAL" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css" />
  <link rel="stylesheet" href="css/blog.css" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="logo" href="index.html"><img src="logo.png" alt="ATTRAL" style="height:40px; width:auto;" /></a>
      <button class="hamburger-menu" aria-label="Toggle menu" id="hamburger-menu-btn">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <nav class="nav">
        <a href="index.html">Home</a>
        <a href="shop.html">Shop</a>
        <a href="account.html">My Account</a>
        <a href="affiliates.html">Affiliate Central</a>
        <a href="contact.html">Contact Us</a>
        <div class="dropdown">
          <a href="#" class="dropdown-toggle" role="button" aria-haspopup="true" aria-expanded="false" aria-label="More menu">More ‚ñæ</a>
          <div class="dropdown-menu" role="menu" aria-labelledby="dropdown-toggle">
            <a href="about.html" role="menuitem">About Us</a>
            <a href="blog.html" role="menuitem" class="active">Blog</a>
            <a href="privacy.html" role="menuitem">Privacy</a>
            <a href="terms.html" role="menuitem">Terms</a>
          </div>
        </div>
        <a href="cart.html" class="cart-link">Cart <span id="cart-count" class="badge">0</span></a>
      </nav>
    </div>
  </header>

  <!-- Mobile Navigation Overlay -->
  <div class="mobile-nav-overlay" id="mobile-nav-overlay"></div>

  <!-- Mobile Navigation Menu -->
  <div class="mobile-nav-menu" id="mobile-nav-menu">
    <div class="mobile-nav-menu-header">
      <button class="mobile-nav-close" aria-label="Close menu" id="mobile-nav-close">√ó</button>
    </div>
    <div class="mobile-nav-menu-content">
      <nav class="nav">
        <a href="index.html">Home</a>
        <a href="shop.html">Shop</a>
        <a href="account.html">My Account</a>
        <a href="affiliates.html">Affiliate Central</a>
        <a href="contact.html">Contact Us</a>
        <a href="about.html">About Us</a>
        <a href="blog.html" class="active">Blog</a>
        <a href="privacy.html">Privacy</a>
        <a href="terms.html">Terms</a>
        <a href="cart.html" class="cart-link">Cart <span id="mobile-cart-count" class="badge">0</span></a>
      </nav>
    </div>
  </div>

  <main>
    <!-- Article Header -->
    <section class="article-header">
      <div class="container">
        <nav class="breadcrumb">
          <a href="index.html">Home</a>
          <span>‚Ä∫</span>
          <a href="blog.html">Blog</a>
          <span>‚Ä∫</span>
          <span id="article-category">Article</span>
        </nav>
        
        <div class="article-meta">
          <span class="category" id="article-category-badge">Category</span>
          <span class="date" id="article-date">Date</span>
          <span class="read-time" id="article-read-time">Read Time</span>
        </div>
        
        <h1 id="article-title-main">Article Title</h1>
        <p class="article-excerpt" id="article-excerpt">Article excerpt will be loaded here...</p>
        
        <div class="article-tags" id="article-tags">
          <!-- Tags will be loaded here -->
        </div>
        
        <div class="article-author">
          <div class="author-info">
            <div class="author-avatar">AT</div>
            <div class="author-details">
              <span class="author-name" id="article-author">Author Name</span>
              <span class="publish-date" id="article-publish-date">Published Date</span>
            </div>
          </div>
          <div class="article-actions">
            <button class="share-btn" onclick="shareArticle()">Share</button>
            <button class="bookmark-btn" onclick="bookmarkArticle()">Bookmark</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Article Content -->
    <article class="article-content">
      <div class="container">
        <div class="article-body" id="article-body">
          <!-- Article content will be loaded here -->
        </div>
        
        <!-- Related Articles -->
        <section class="related-articles">
          <h3>Related Articles</h3>
          <div class="related-grid" id="related-articles">
            <!-- Related articles will be loaded here -->
          </div>
        </section>
      </div>
    </article>

    <!-- Newsletter Signup -->
    <section class="newsletter-section">
      <div class="container">
        <div class="newsletter-card">
          <div class="newsletter-content">
            <h3>Enjoyed This Article?</h3>
            <p>Get more insights and charging tips delivered to your inbox</p>
            <form class="newsletter-form" id="newsletter-form">
              <div class="form-group">
                <input type="email" id="newsletter-email" placeholder="Enter your email" required />
                <button type="submit" class="btn btn-primary">Subscribe</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container footer-inner">
      <div class="footer-content">
        <div class="footer-section">
          <h4>About ATTRAL</h4>
          <p>Smart Power. Smarter Living. We provide next-gen consumer electronics to power your lifestyle with cutting-edge GaN technology.</p>
          <div class="social-links">
            <a href="https://facebook.com/attral" target="_blank" rel="noopener" title="Follow us on Facebook">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
              </svg>
            </a>
            <a href="https://instagram.com/attral" target="_blank" rel="noopener" title="Follow us on Instagram">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 6.62 5.367 11.987 11.988 11.987s11.987-5.367 11.987-11.987C24.014 5.367 18.637.001 12.017.001zM8.449 16.988c-1.297 0-2.448-.49-3.323-1.297C4.198 14.895 3.708 13.744 3.708 12.447s.49-2.448 1.297-3.323c.875-.807 2.026-1.297 3.323-1.297s2.448.49 3.323 1.297c.807.875 1.297 2.026 1.297 3.323s-.49 2.448-1.297 3.323c-.875.807-2.026 1.297-3.323 1.297zm7.83-9.281H7.83c-.49 0-.89.4-.89.89v7.83c0 .49.4.89.89.89h8.449c.49 0 .89-.4.89-.89v-7.83c0-.49-.4-.89-.89-.89z"/>
              </svg>
            </a>
            <a href="https://twitter.com/attral" target="_blank" rel="noopener" title="Follow us on Twitter">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
              </svg>
            </a>
            <a href="https://linkedin.com/company/attral" target="_blank" rel="noopener" title="Connect on LinkedIn">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
              </svg>
            </a>
          </div>
        </div>
        <div class="footer-section">
          <h4>Quick Links</h4>
          <p><a href="index.html">Home</a></p>
          <p><a href="shop.html">Shop</a></p>
          <p><a href="about.html">About Us</a></p>
          <p><a href="contact.html">Contact</a></p>
        </div>
        <div class="footer-section">
          <h4>Support</h4>
          <p><a href="account.html">My Account</a></p>
          <p><a href="cart.html">Shopping Cart</a></p>
          <p><a href="affiliates.html">Affiliate Program</a></p>
          <p><a href="blog.html">Blog</a></p>
        </div>
        <div class="footer-section">
          <h4>Contact Info</h4>
          <p>üìß info@attral.in</p>
          <p>üì± +91 8903479870</p>
          <p>üìç Phase 2 Sathuvachari<br>Vellore - 632009<br>Tamil Nadu, India</p>
        </div>
      </div>
      <div class="footer-bottom">
        <p>¬© <span id="year"></span> ATTRAL. All rights reserved.</p>
        <nav>
          <a href="privacy.html">Privacy Policy</a>
          <a href="terms.html">Terms of Service</a>
          <a href="sitemap.xml">Sitemap</a>
        </nav>
      </div>
    </div>
  </footer>

  <script src="js/config.js"></script>
  <script src="js/app.js"></script>
  <script src="js/firebase.js"></script>
  <script src="js/dropdown.js"></script>
  <script>
    // Article functionality
    let blogData = null;
    let currentArticle = null;

    // Load blog data and article
    async function loadArticle() {
      try {
        // Get article slug from URL
        const urlParams = new URLSearchParams(window.location.search);
        const slug = urlParams.get('slug');
        
        if (!slug) {
          window.location.href = 'blog.html';
          return;
        }

        // Load blog data
        const response = await fetch('data/blog.json');
        blogData = await response.json();
        
        // Find article by slug
        currentArticle = blogData.articles.find(article => article.slug === slug);
        
        if (!currentArticle) {
          showError('Article not found');
          return;
        }

        // Load article content
        loadArticleContent();
        loadRelatedArticles();
        
      } catch (error) {
        console.error('Failed to load article:', error);
        showError('Failed to load article. Please try again later.');
      }
    }

    // Load article content
    function loadArticleContent() {
      if (!currentArticle) return;

      // Update page title and meta
      document.getElementById('article-title').textContent = currentArticle.title;
      document.getElementById('article-description').setAttribute('content', currentArticle.excerpt);
      document.getElementById('article-title-main').textContent = currentArticle.title;
      document.getElementById('article-excerpt').textContent = currentArticle.excerpt;
      
      // Update meta information
      document.getElementById('article-category').textContent = currentArticle.category;
      document.getElementById('article-category-badge').textContent = currentArticle.category;
      document.getElementById('article-date').textContent = formatDate(currentArticle.date);
      document.getElementById('article-read-time').textContent = currentArticle.readTime;
      document.getElementById('article-author').textContent = currentArticle.author;
      document.getElementById('article-publish-date').textContent = formatDate(currentArticle.date);
      
      // Update tags
      const tagsContainer = document.getElementById('article-tags');
      tagsContainer.innerHTML = currentArticle.tags.map(tag => 
        `<span class="tag">${tag}</span>`
      ).join('');
      
      // Update article content
      const contentContainer = document.getElementById('article-body');
      contentContainer.innerHTML = formatArticleContent(currentArticle.content);
    }

    // Load related articles
    function loadRelatedArticles() {
      if (!blogData || !currentArticle) return;

      const related = blogData.articles
        .filter(article => 
          article.slug !== currentArticle.slug && 
          article.category === currentArticle.category
        )
        .slice(0, 3);

      const relatedContainer = document.getElementById('related-articles');
      relatedContainer.innerHTML = related.map(article => `
        <div class="related-card">
          <div class="related-image">
            <img src="${article.image}" alt="${article.title}" />
          </div>
          <div class="related-content">
            <h4><a href="article.html?slug=${article.slug}">${article.title}</a></h4>
            <p>${article.excerpt.substring(0, 100)}...</p>
            <div class="related-meta">
              <span class="date">${formatDate(article.date)}</span>
              <span class="read-time">${article.readTime}</span>
            </div>
          </div>
        </div>
      `).join('');
    }

    // Format article content
    function formatArticleContent(content) {
      // Convert markdown-like formatting to HTML in correct order
      let html = content;

      // Inline formatting first
      html = html
        .replace(/`(.*?)`/g, '<code>$1</code>')
        .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
        .replace(/\*(.*?)\*/g, '<em>$1</em>')
        .replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2">$1</a>');

      // Block elements: headings before paragraph wrapping
      html = html
        .replace(/^###\s+(.+)$/gm, '<h3>$1</h3>')
        .replace(/^##\s+(.+)$/gm, '<h2>$1</h2>')
        .replace(/^#\s+(.+)$/gm, '<h1>$1</h1>')
        .replace(/^>\s+(.+)$/gm, '<blockquote>$1</blockquote>');

      // Lists: convert contiguous lines into lists
      // Ordered lists
      html = html.replace(/(?:^|\n)(\d+\.\s+.*(?:\n\d+\.\s+.*)*)/gm, function(match) {
        const items = match.trim().split(/\n/).map(line => line.replace(/^\d+\.\s+/, ''));
        return '<ol>' + items.map(i => '<li>' + i + '</li>').join('') + '</ol>';
      });
      // Unordered lists
      html = html.replace(/(?:^|\n)(-\s+.*(?:\n-\s+.*)*)/gm, function(match) {
        const items = match.trim().split(/\n/).map(line => line.replace(/^-\s+/, ''));
        return '<ul>' + items.map(i => '<li>' + i + '</li>').join('') + '</ul>';
      });

      // Paragraphs: wrap remaining text blocks separated by blank lines
      html = html
        .split(/\n{2,}/)
        .map(block => {
          const trimmed = block.trim();
          if (!trimmed) return '';
          // Do not wrap if block already starts with a block tag
          if (/^(<h1|<h2|<h3|<ul|<ol|<blockquote)/.test(trimmed)) return trimmed;
          return '<p>' + trimmed.replace(/\n/g, '<br>') + '</p>';
        })
        .join('');

      return html;
    }

    // Share article
    function shareArticle() {
      if (navigator.share) {
        navigator.share({
          title: currentArticle.title,
          text: currentArticle.excerpt,
          url: window.location.href
        });
      } else {
        // Fallback: copy to clipboard
        navigator.clipboard.writeText(window.location.href).then(() => {
          showSuccess('Link copied to clipboard!');
        });
      }
    }

    // Bookmark article
    function bookmarkArticle() {
      const bookmarks = JSON.parse(localStorage.getItem('attral_bookmarks') || '[]');
      const articleId = currentArticle.slug;
      
      if (bookmarks.includes(articleId)) {
        bookmarks.splice(bookmarks.indexOf(articleId), 1);
        showSuccess('Article removed from bookmarks');
      } else {
        bookmarks.push(articleId);
        showSuccess('Article bookmarked!');
      }
      
      localStorage.setItem('attral_bookmarks', JSON.stringify(bookmarks));
      updateBookmarkButton();
    }

    // Update bookmark button
    function updateBookmarkButton() {
      const bookmarks = JSON.parse(localStorage.getItem('attral_bookmarks') || '[]');
      const bookmarkBtn = document.querySelector('.bookmark-btn');
      
      if (bookmarks.includes(currentArticle.slug)) {
        bookmarkBtn.textContent = 'Bookmarked ‚úì';
        bookmarkBtn.classList.add('bookmarked');
      } else {
        bookmarkBtn.textContent = 'Bookmark';
        bookmarkBtn.classList.remove('bookmarked');
      }
    }

    // Utility functions
    function formatDate(dateString) {
      const date = new Date(dateString);
      return date.toLocaleDateString('en-US', { 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric' 
      });
    }

    function showError(message) {
      const errorDiv = document.createElement('div');
      errorDiv.className = 'error-message';
      errorDiv.textContent = message;
      document.querySelector('.container').prepend(errorDiv);
      setTimeout(() => errorDiv.remove(), 5000);
    }

    function showSuccess(message) {
      const successDiv = document.createElement('div');
      successDiv.className = 'success-message';
      successDiv.textContent = message;
      document.querySelector('.container').prepend(successDiv);
      setTimeout(() => successDiv.remove(), 5000);
    }

    // Newsletter form
    document.getElementById('newsletter-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const email = document.getElementById('newsletter-email').value;
      if (email) {
        showSuccess('Thanks for subscribing! You\'ll receive our latest articles.');
        this.reset();
      }
    });

    // Initialize when page loads
    document.addEventListener('DOMContentLoaded', function() {
      loadArticle();
      document.getElementById('year').textContent = new Date().getFullYear();
    });
  </script>
</body>
</html>
